<div class="main-wrapper">
  <div class="header-section mb-2">
    <div class="d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center">
        <i class="bi bi-gear-fill text-white fs-1 me-3"></i>
        <h2 class="text-white fw-bold mb-0">Master Management</h2>
      </div>

      <div class="d-flex gap-3 align-items-center">
        <button class="btn btn-lg px-4 py-2 rounded-pill shadow-sm toggle-btn"
          [ngClass]="activeFilter === 'all' ? 'btn-light' : 'btn-outline-light'" (click)="filterItems('all')">
          <i class="bi bi-grid-fill me-2"></i>All
        </button>

        <button class="btn btn-lg px-4 py-2 rounded-pill shadow-sm toggle-btn"
          [ngClass]="activeFilter === 'Payment' ? 'btn-light' : 'btn-outline-light'" (click)="filterItems('Payment')">
          <i class="bi bi-credit-card me-2"></i>Payment Mode
        </button>

        <button class="btn btn-lg px-4 py-2 rounded-pill shadow-sm toggle-btn"
          [class.btn-light]="activeFilter === 'Refrence'" [class.btn-outline-light]="activeFilter !== 'Refrence'"
          (click)="filterItems('Refrence')">
          <i class="bi bi-bookmark me-2"></i>Reference By
        </button>

        <button class="btn btn-primary btn-lg px-4 py-2 rounded-pill shadow-sm" *ngIf="!showForm" (click)="openForm()">
          <i class="bi bi-plus-circle me-2"></i>Add Master
        </button>
      </div>
    </div>
  </div>
  @if(alertMsgData().alertType!=''){
  <app-alert-box class="mb-0" [alertType]="alertMsgData().alertType"
    [alertMessage]="alertMsgData().alertMessage"></app-alert-box>
  } @if(loderData().loaderType=='content'){
  <app-loader [loaderType]="loderData().loaderType"></app-loader>
  }

  <div class="content-container" [class.form-open]="showForm">
    <div class="cards-section">
      <div class="cards-grid">
        <div *ngFor="let master of filteredMasterData; let i = index" class="card-wrapper scale-in"
          [style.animation-delay]="i * 0.05 + 's'">
          <div class="card border-0 shadow-lg h-100 hover-card">
            <div class="card-body p-4">
              <div class="d-flex align-items-center mb-3">
                <i [class]="
                    'bi ' + icons.get(master.masterValue.toUpperCase()) + ' text-primary fs-4 me-2'
                  "></i>
                <h6 class="card-title text-primary fw-bold mb-0">
                  {{ master.masterFor }}
                </h6>
              </div>
              <div class="mb-3">
                <span class="card-value fw-bold fs-5">{{ master.masterValue }}</span>
              </div>

              <div class="d-flex gap-2">
                <button class="btn btn-sm btn-outline-primary flex-grow-1" (click)="editItem(master)">
                  <i class="bi bi-pencil me-1"></i>Edit
                </button>
                <button class="btn btn-sm btn-outline-danger flex-grow-1" (click)="deleteItem(master.masterId)">
                  <i class="bi bi-trash me-1"></i>Delete
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="divider-line" *ngIf="showForm"></div>

    <div class="form-section slide-in" *ngIf="showForm">
      <div class="form-container">
        <div class="d-flex justify-content-between align-items-center mb-4 pb-3 border-bottom">
          <h5 class="mb-0 text-primary fw-bold">
            <i class="bi bi-pencil-square me-2"></i>Add / Edit Master
          </h5>
          <button class="btn btn-sm btn-outline-secondary rounded-circle close-btn" (click)="closeForm()">
            <i class="bi bi-x-lg"></i>
          </button>
        </div>

        <form (ngSubmit)="saveFormData()" #masterFormData="ngForm">
          <div class="form-group mb-4">
            <label class="form-label fw-semibold">
              <i class="bi bi-tag text-primary me-2"></i>Master For
            </label>
            <input type="text" class="form-control form-control-lg" [(ngModel)]="masterForm.masterFor" name="type"
              placeholder="Enter Master For (e.g. Payment Type)" required />
          </div>

          <div class="form-group mb-4">
            <label class="form-label fw-semibold">
              <i class="bi bi-box-seam text-primary me-2"></i>Master Value
            </label>
            <input type="text" class="form-control form-control-lg" [(ngModel)]="masterForm.masterValue" name="value"
              placeholder="Enter Master Value (e.g. Cash, UPI, Card)" required />
          </div>

          <button type="submit" class="btn btn-primary btn-lg w-100 py-3 fw-semibold">
            @if(loderData().loaderType=='button'){
            <app-loader [loaderType]="loderData().loaderType"></app-loader>
            }
            <i class="bi bi-check-circle me-2"></i>{{ isEdit == true ? 'Edit' : 'Save' }}
          </button>
        </form>
      </div>
    </div>
  </div>
</div>